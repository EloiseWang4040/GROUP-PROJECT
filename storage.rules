rules_version = '2';

// Craft rules based on data in your Firestore database
// allow write: if firestore.get(
//    /databases/(default)/documents/users/$(request.auth.uid)).data.isAdmin;
service firebase.storage {
  match /b/{bucket}/o {
    // ユーザーは自分のフォルダ (uploads/{userId}/) のみを読み書きできる
    match /uploads/{userId}/{allPaths=**} {
      allow read, write: if true;
    }

    // 他のパスへのアクセスはデフォルトで拒否 (明示的な許可がないため)
    // 必要に応じて、公開読み取り可能なパスなどをここに追加できます
    // 例: 公開画像を保存する public/ フォルダ
    // match /public/{allPaths=**} {
    //   allow read: if true;
    //   allow write: if false; // または特定の管理ユーザーのみ許可など
    // }
  }
}
